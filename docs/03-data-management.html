<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Introduction to SPSS - 3&nbsp; Understanding Data Management Tasks</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./04-stats.html" rel="next">
<link href="./02-variables.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./03-data-management.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Management Tasks</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Introduction to SPSS</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview of the Workshop</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-basics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">The Basics of SPSS</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-variables.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with Variables</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-data-management.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Management Tasks</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-stats.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Understanding Graphical &amp; Statistical Procedures</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Appendix</span></span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#sorting-cases" id="toc-sorting-cases" class="nav-link active" data-scroll-target="#sorting-cases"><span class="header-section-number">3.1</span> Sorting Cases</a></li>
  <li><a href="#analyzing-subsets-of-data" id="toc-analyzing-subsets-of-data" class="nav-link" data-scroll-target="#analyzing-subsets-of-data"><span class="header-section-number">3.2</span> Analyzing Subsets of Data</a>
  <ul>
  <li><a href="#if-condition-is-satisfied" id="toc-if-condition-is-satisfied" class="nav-link" data-scroll-target="#if-condition-is-satisfied"><span class="header-section-number">3.2.1</span> If Condition is Satisfied</a></li>
  <li><a href="#randomly-selecting-subsets" id="toc-randomly-selecting-subsets" class="nav-link" data-scroll-target="#randomly-selecting-subsets"><span class="header-section-number">3.2.2</span> Randomly Selecting Subsets</a></li>
  <li><a href="#output-options" id="toc-output-options" class="nav-link" data-scroll-target="#output-options"><span class="header-section-number">3.2.3</span> Output Options</a></li>
  </ul></li>
  <li><a href="#analyzing-groups-of-data-separately" id="toc-analyzing-groups-of-data-separately" class="nav-link" data-scroll-target="#analyzing-groups-of-data-separately"><span class="header-section-number">3.3</span> Analyzing Groups of Data Separately</a></li>
  <li><a href="#exercise-5-subsetting-data" id="toc-exercise-5-subsetting-data" class="nav-link" data-scroll-target="#exercise-5-subsetting-data"><span class="header-section-number">3.4</span> Exercise 5 – Subsetting Data</a></li>
  <li><a href="#merging-files" id="toc-merging-files" class="nav-link" data-scroll-target="#merging-files"><span class="header-section-number">3.5</span> Merging Files</a>
  <ul>
  <li><a href="#adding-cases" id="toc-adding-cases" class="nav-link" data-scroll-target="#adding-cases"><span class="header-section-number">3.5.1</span> Adding Cases</a></li>
  <li><a href="#adding-variables" id="toc-adding-variables" class="nav-link" data-scroll-target="#adding-variables"><span class="header-section-number">3.5.2</span> Adding Variables</a></li>
  </ul></li>
  <li><a href="#converting-data-formats" id="toc-converting-data-formats" class="nav-link" data-scroll-target="#converting-data-formats"><span class="header-section-number">3.6</span> Converting Data Formats</a>
  <ul>
  <li><a href="#wide-to-long-aka-variables-into-cases" id="toc-wide-to-long-aka-variables-into-cases" class="nav-link" data-scroll-target="#wide-to-long-aka-variables-into-cases"><span class="header-section-number">3.6.1</span> Wide to Long (AKA “Variables into Cases”)</a></li>
  <li><a href="#long-to-wide-aka-cases-into-variables" id="toc-long-to-wide-aka-cases-into-variables" class="nav-link" data-scroll-target="#long-to-wide-aka-cases-into-variables"><span class="header-section-number">3.6.2</span> Long to Wide (AKA “Cases into Variables”)</a></li>
  </ul></li>
  <li><a href="#exercise-6-restructuring-i-wide-to-long" id="toc-exercise-6-restructuring-i-wide-to-long" class="nav-link" data-scroll-target="#exercise-6-restructuring-i-wide-to-long"><span class="header-section-number">3.7</span> Exercise 6 – Restructuring I (Wide to Long)</a></li>
  <li><a href="#exercise-7-restructuring-ii-long-to-wide" id="toc-exercise-7-restructuring-ii-long-to-wide" class="nav-link" data-scroll-target="#exercise-7-restructuring-ii-long-to-wide"><span class="header-section-number">3.8</span> Exercise 7 – Restructuring II (Long to Wide)</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding Data Management Tasks</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>Data for this section: <a href="data/section3_data.sav">section3_data.sav</a></p>
<section id="sorting-cases" class="level2" data-number="3.1">
<h2 data-number="3.1" class="anchored" data-anchor-id="sorting-cases"><span class="header-section-number">3.1</span> Sorting Cases</h2>
<p>Sorting cases based on a particular variable is often necessary when managing data sets. Go to Data -&gt; Sort Cases to place the cases in order. Choose the variable that determines the ordering, and choose “Ascending” or “Descending”.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image42.png" target="_blank"><img src="./media/spss-image42.png" style="width:4.04167in;height:3.88542in" class="figure-img"></a></p>
</figure>
</div>
<p>Selecting the ID variable and choosing “Ascending” will place the subject with the smallest ID number in the top row. The bottom row will contain data on the subject with the largest (highest) ID number.</p>
<p>When sorting by more than one variable, SPSS sorts the data initially based on the first variable. Within each value of that first variable, it sorts again based on the second variable. Make sure to select “Ascending” or “Descending” for each variable when you are sorting by multiple variables. Highlight the variable by clicking on it, and choose the correct ordering.</p>
<p>Suppose we want to sort by gender and then by age, with both in ascending order. Suppose the codes for gender are as follows:</p>
<ul>
<li>0: male</li>
<li>1: female</li>
</ul>
<p>SPSS would first put males at the top of the file and females at the bottom. SPSS would then sort by age within each gender group. The first rows of the data set would contain the youngest men in the sample and the last subjects at the bottom would be the oldest women in the sample.</p>
</section>
<section id="analyzing-subsets-of-data" class="level2" data-number="3.2">
<h2 data-number="3.2" class="anchored" data-anchor-id="analyzing-subsets-of-data"><span class="header-section-number">3.2</span> Analyzing Subsets of Data</h2>
<p>You can use the “Select Cases” command to instruct the software to calculate statistical results or summaries based on only some of the cases in the data set. You can define the subset by certain characteristics, such as women over age 40, or you can instruct the software to select a random sample of cases with size that you specify.</p>
<p><strong>Note:</strong> The Select Cases procedure affects which cases that SPSS includes in analysis and output only. It has no effect on transformations of the data, such as computing, recoding, or counting.</p>
<p>Selecting cases involves turning on a filter that handles the inclusion of certain cases and the exclusion of others. When the filter is on, analyses or summaries will only use the selected cases. There will be a message “Filter On” at the bottom right of the Data Editor window whenever SPSS is using only selected cases.</p>
<p>The first time you invoke the “Select Cases” procedure, the software creates a variable called filter_$ in the data set. This variable is equal to 0 for excluded cases and 1 for included cases. SPSS deletes and then re-creates the filter_$ variable each time you run “Select Cases”.</p>
<p>Users can specify their own filter variable. He or she can use any variable as a filter as long as a value of 0 for that variable indicates exclusion and a value of 1 inclusion. Click the “Use filter variable” option under Data -&gt; Select Cases to do this; move your filter variable into the box.</p>
<section id="if-condition-is-satisfied" class="level3" data-number="3.2.1">
<h3 data-number="3.2.1" class="anchored" data-anchor-id="if-condition-is-satisfied"><span class="header-section-number">3.2.1</span> If Condition is Satisfied</h3>
<p>Go to Data -&gt; Select Cases to use only some of the cases. Click “If condition is satisfied….” to select cases based on certain criteria. Then click the “If…” button to pull up a window in which you will state the condition. Some example conditions are:</p>
<ul>
<li><code>gender = 'm'</code> - selects men only</li>
<li><code>age &lt;= 12 and sex = 2</code> - selects children 12 and under of one sex only</li>
<li><code>marital = 0</code> -selects all never married respondents</li>
</ul>
<p>You can return to the data editor by clicking “Continue” and “OK”. Notice that certain rows have been “scratched” out by SPSS. SPSS has filtered out these cases because they did not satisfy the specified condition. Analyses will only use those cases that are not scratched out.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image43.png" target="_blank"><img src="./media/spss-image43.png" style="width:5.23958in;height:4.72917in" class="figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image44.png" target="_blank"><img src="./media/spss-image44.png" style="width:6.5in;height:4.03125in" class="figure-img"></a></p>
</figure>
</div>
<p>To return to the entire sample, go to Data -&gt; Select Cases, choose the radio button next to “All Cases,” and then click “OK”. The “Filter On” message will disappear and all results from that point on refer to the entire data set.</p>
</section>
<section id="randomly-selecting-subsets" class="level3" data-number="3.2.2">
<h3 data-number="3.2.2" class="anchored" data-anchor-id="randomly-selecting-subsets"><span class="header-section-number">3.2.2</span> Randomly Selecting Subsets</h3>
<p>You may examine a randomly selected portion of the data by clicking “Random Sample of Cases” in the “Select Cases” window. Then click the “Sample…” button. You can then give an approximate percentage. If you want to take an exact number of cases, first determine the total number of cases (rows) and place this number in the “from the first --- cases” segment of the dialogue box. If you would like to take a precise number of cases from, say, all women, or all children under twelve, then sort the data first so that the cases of interest occupy the first rows. Determine the last row that refers to a female, or to a child under twelve, and proceed as above.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image45.png" target="_blank"><img src="./media/spss-image45.png" style="width:3.96875in;height:1.54167in" class="figure-img"></a></p>
</figure>
</div>
<p><strong>Note:</strong> When SPSS selects cases randomly, repeated selections will be different even when everything specified by the user has stayed the same. An approximate 30% sample of cases will result in a different 30% each time the user repeats the procedure.</p>
<p><strong>Helpful Hint:</strong> To use the same random selection of cases over and over again, first take the initial random sample. Then re-name the filter_$ variable to any name of your choosing. SPSS will leave the variable alone, and you can re-use the filter in consecutive SPSS sessions.</p>
</section>
<section id="output-options" class="level3" data-number="3.2.3">
<h3 data-number="3.2.3" class="anchored" data-anchor-id="output-options"><span class="header-section-number">3.2.3</span> Output Options</h3>
<p>At the bottom of the “Select Cases” dialogue box are three options:</p>
<ul>
<li>Filter out unselected cases (recommended)</li>
<li>Copy selected cases to a new dataset (recommended)</li>
<li>Delete unselected cases (NOT RECOMMENDED)</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image46.png" target="_blank"><img src="./media/spss-image46.png" style="width:5.23958in;height:5.3125in" class="figure-img"></a></p>
</figure>
</div>
<p>If you set this to “Filter out unselected cases”, the unselected cases remain in the data set but the software temporarily excludes them from all analyses. If you choose the second option, SPSS copies the selected cases to a new dataset and you can save the dataset on your disk by assigning a file name. The content of your original dataset remains untouched with these two options.</p>
<p>If the you change the option to “Delete unselected cases”, unselected cases disappear from the data entirely. Be careful when permanently deleting cases, because you CANNOT undo the deletion. Make sure to first save your data file under a different name if you wish to permanently delete cases.</p>
<p><strong>Try it: Use <a href="data/section3_data.sav">section3_data.sav</a>. Select only observations with Education = 1 for analysis. </strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image47.png" target="_blank"><img src="./media/spss-image47.png" style="width:6.05625in;height:3.84375in" class="figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image48.png" target="_blank"><img src="./media/spss-image48.png" style="width:6.5in;height:2.72917in" class="figure-img"></a></p>
</figure>
</div>
</section>
</section>
<section id="analyzing-groups-of-data-separately" class="level2" data-number="3.3">
<h2 data-number="3.3" class="anchored" data-anchor-id="analyzing-groups-of-data-separately"><span class="header-section-number">3.3</span> Analyzing Groups of Data Separately</h2>
<p>When analyzing groups of cases separately, such as men and women, the Split File command spares you from having to repeatedly select different groups of cases.</p>
<p>The Split File command first sorts the data into groups based on a specified variable. After that, SPSS generates any requested output for each group separately. If we split the file based on gender and then request the mean current salary, we would receive a mean current salary for men and a mean current salary for women. A flag at the bottom right of the data editor will read “Split File On” when you are using this option.</p>
<p>You can use multiple variables to divide the data. If you use both gender and job category as grouping variables, for example, then SPSS will give all output for each job category group within each gender.</p>
<p>To use Split File:</p>
<ul>
<li>Go to Data -&gt; Split File.</li>
<li>Click on “Compare Groups” or “Organize Output by Groups”.</li>
<li>Select variable(s) which divide the data into groups.</li>
<li>Click OK.</li>
<li>To turn off the Split File command, return to Data -&gt; Split File and click on “Analyze all cases, do not create groups”.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image49.png" target="_blank"><img src="./media/spss-image49.png" style="width:4.625in;height:3.58333in" class="figure-img"></a></p>
</figure>
</div>
<p><strong>Try it: Use <a href="data/section3_data.sav">section3_data.sav</a>. Obtain the descriptive statistics for DepScale_01 for males and females separately. Hint: Select Analyze -&gt; Descriptive Statistics -&gt; Descriptives.</strong></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image50.png" target="_blank"><img src="./media/spss-image50.png" style="width:3.93125in;height:2.875in" class="figure-img"></a></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image-splitfile.png" target="_blank"><img src="./media/spss-image-splitfile.png" style="width:5in;height:1.5in" class="figure-img"></a></p>
</figure>
</div>
</section>
<section id="exercise-5-subsetting-data" class="level2" data-number="3.4">
<h2 data-number="3.4" class="anchored" data-anchor-id="exercise-5-subsetting-data"><span class="header-section-number">3.4</span> Exercise 5 – Subsetting Data</h2>
<p>Open <a href="data/exercise5/exercise5_data.sav">exercise5_data.sav</a>.</p>
<p>Select male managers. What is their average age?</p>
<p>(You can obtain the average age by choosing Analyze -&gt; Descriptive Statistics -&gt; Descriptives and moving “Age of Respondent (age)” to the right hand side.)</p>
<p>Use the “Split File” procedure to get the average age for each job category.</p>
</section>
<section id="merging-files" class="level2" data-number="3.5">
<h2 data-number="3.5" class="anchored" data-anchor-id="merging-files"><span class="header-section-number">3.5</span> Merging Files</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/merging_image1.png" target="_blank"><img src="./media/merging_image1.png" width="576" height="432" class="figure-img"></a></p>
</figure>
</div>
<section id="adding-cases" class="level3" data-number="3.5.1">
<h3 data-number="3.5.1" class="anchored" data-anchor-id="adding-cases"><span class="header-section-number">3.5.1</span> Adding Cases</h3>
<p>Suppose you have two files containing data on different cases, in which many of the variables are the same in name and format. You can merge these files together using the Add Cases command.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/merging_image2.png" target="_blank"><img src="./media/merging_image2.png" class="img-fluid figure-img"></a></p>
</figure>
</div>
<p>To merge the files, the basic steps are:</p>
<ul>
<li>Open the first data file.</li>
<li>Go to Data -&gt; Merge Files -&gt; Add Cases.</li>
<li>Find and select the second file, containing the additional cases.</li>
<li>Choose variables to be included in the resulting file.</li>
<li>Click OK.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/merging_image3.png" target="_blank"><img src="./media/merging_image3.png" style="width:3.85417in;height:3.19081in" class="figure-img"></a></p>
</figure>
</div>
<p>Inside the Add Cases dialogue window, one variable box on the right will have label “Variables in New Active Dataset”. Any variable listed in this box exists in both files under the same name, and will automatically be included in the resulting data set.</p>
<p>Variables listed in the left box are those that SPSS was not certain what to do with. They may appear in only one data set, or the variables in the two data sets may be named slightly differently. One data set we might use the variable number “sex” and the second the variable name “gender”, for example.</p>
<p>Variable names might come from the active data set or from the external file. SPSS indicates the origin of the name by assigning these symbols:</p>
<ul>
<li>the current (working) data file: <code>*</code></li>
<li>the second (external) data file: <code>+</code></li>
</ul>
<p>When a variable exists in only one data file, and it is not simply a matter of mismatched names, simply move the variable into the right-hand box. The variable will exist in the resulting merged file and will have only missing values for one group of cases.</p>
<p>If two variables have different names, on the other hand, then select both variable names and click the “Pair” button. Before pairing them, you may want to rename one of the two to match the other; simply select the one whose name you would like to change and click “Rename”. If you do not use the Rename option, the software will use the name from the current working data file.</p>
<p>The last option is the box labeled “Indicate case source as variable”. If you check this box, you can specify a name for a variable in the new file that will indicate the file that the case came from.</p>
<p>SPSS sets up the new variable as follows:</p>
<ul>
<li>0 indicates the case came from the currently open data set</li>
<li>1 indicates that the case is from the external (2nd) data set</li>
</ul>
</section>
<section id="adding-variables" class="level3" data-number="3.5.2">
<h3 data-number="3.5.2" class="anchored" data-anchor-id="adding-variables"><span class="header-section-number">3.5.2</span> Adding Variables</h3>
<p>Suppose that we have files containing the same subjects, but different information. If we want to combine all the information into one new file, we want to add variables to one of the files.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/merging_image4.png" target="_blank"><img src="./media/merging_image4.png" width="576" height="432" class="figure-img"></a></p>
</figure>
</div>
<p>Before actually using the “Add Variables” procedure, which is found under Data -&gt; Merge Files -&gt; Add Variables, there are certain prerequisites that SPSS is very insistent upon:</p>
<ul>
<li>Both files must contain a key “matching” variable, usually ID, which will be the basis for linking up each row of data.</li>
<li>This key matching variable must be of the same type, including the same length. Preferably, it should have the same name.</li>
<li>Each data file must be sorted in ascending order based upon the key matching variable. Save each file in its sorted form.</li>
</ul>
<p><strong>Note:</strong> it is NOT necessary to have exactly the same cases in both files.</p>
<p>If all of these conditions are met, we can proceed with the Add Variables procedure. The first step is to identify the external file that we will obtain the new variables from. SPSS identifies variables as follows:</p>
<ul>
<li>from the working, or current, data file: <code>(*)</code></li>
<li>from the second, or external, data file: <code>(+)</code></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/merging_image5.png" target="_blank"><img src="./media/merging_image5.png" style="width:6.5in;height:4.67879in" class="figure-img"></a></p>
</figure>
</div>
<p>There are two locations where we can find variable names in the Add Variables dialogue box. The right box, labeled “New Active Dataset:”, lists the variables from the external dataset to include, and the left lists the excluded variables. The excluded variables are those which were found in both files. If the same variable is in both files, SPSS isn’t sure which one to accept in the resulting file, since there cannot be duplicate variable names. It will exclude one of the two variables.</p>
<p>Click the box marked “Match cases on key variables in sorted files”. Next, find the ID variable from either data file, and move it into the “Key Variables” box. If the ID variables have different names, then first rename the variables so that they match.</p>
<p>There are three options underneath the box marked “Match cases on key variables in sorted files”. The options which include the phrase “keyed table” typically refer to merging with aggregated datasets. If the data file that is being merged into the working data file has at most one record per value of the key variable(s), then use the option “Non-active dataset is Keyed Table” in most cases.</p>
<p>There are two things to understand about applying aggregate data:</p>
<ul>
<li>The key matching variable is the one that identifies each aggregate case.</li>
<li>The phrase “keyed table” refers to the aggregate data set.</li>
</ul>
<p>SPSS uses the key variable to go to the aggregate data set, look up the information for that group (e.g., job category), and take that information back to each and every individual in that group in the original data file. For that reason, SPSS sees the aggregate data set as a reference table, which of course includes the key variable that attaches the appropriate information to the individuals.</p>
<p>If you begin in the individual data set, go to Add Variables and proceed as if both files have individual data. Then select the “Non-active dataset is keyed table” option, notifying SPSS that the external file is really nothing more than a reference table from which to obtain information for each individual case. If you begin in the aggregate data set, which typically has fewer rows, then select “Active dataset is keyed table”.</p>
</section>
</section>
<section id="converting-data-formats" class="level2" data-number="3.6">
<h2 data-number="3.6" class="anchored" data-anchor-id="converting-data-formats"><span class="header-section-number">3.6</span> Converting Data Formats</h2>
<p>Different statistical methods frequently require different data formats. A repeated measures analysis of variance, for example, requires that data be in Wide format, while a linear mixed model requires that the data be in Long format. SPSS makes it easy to convert between the two formats. The examples below demonstrate how to use the wizard in SPSS.</p>
<p>To convert a dataset from one format to the other, first select “Data” and then “Restructure”. SPSS uses terminology that differs from conventional phrasing.</p>
<ul>
<li>Wide to Long Variables into Cases</li>
<li>Long to Wide Cases into Variables</li>
</ul>
<p>We will briefly discuss these two variations, before doing exercises together which include the instructions.</p>
<section id="wide-to-long-aka-variables-into-cases" class="level3" data-number="3.6.1">
<h3 data-number="3.6.1" class="anchored" data-anchor-id="wide-to-long-aka-variables-into-cases"><span class="header-section-number">3.6.1</span> Wide to Long (AKA “Variables into Cases”)</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image51.jpeg" target="_blank"><img src="./media/spss-image51.jpeg" style="width:5.98958in;height:4.49219in" class="figure-img"></a></p>
</figure>
</div>
<p>There are seven steps in this Wizard:</p>
<ol type="1">
<li>Identify the restructuring plan to be from “Variables into Cases”.</li>
<li>Select the number of variable groups.</li>
<li>Select variables.</li>
<li>Create index variables (usually one).</li>
<li>Create one index variable.</li>
<li>Choose options.</li>
<li>Finish.</li>
</ol>
</section>
<section id="long-to-wide-aka-cases-into-variables" class="level3" data-number="3.6.2">
<h3 data-number="3.6.2" class="anchored" data-anchor-id="long-to-wide-aka-cases-into-variables"><span class="header-section-number">3.6.2</span> Long to Wide (AKA “Cases into Variables”)</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./media/spss-image52.jpeg" target="_blank"><img src="./media/spss-image52.jpeg" style="width:5.22917in;height:3.92188in" class="figure-img"></a></p>
</figure>
</div>
<p>There are five steps in this Wizard:</p>
<ol type="1">
<li>Identify the restructuring plan as “Cases into Variables”.</li>
<li>Select variables.</li>
<li>Sort the data.</li>
<li>Choose options.</li>
<li>Finish.</li>
</ol>
</section>
</section>
<section id="exercise-6-restructuring-i-wide-to-long" class="level2" data-number="3.7">
<h2 data-number="3.7" class="anchored" data-anchor-id="exercise-6-restructuring-i-wide-to-long"><span class="header-section-number">3.7</span> Exercise 6 – Restructuring I (Wide to Long)</h2>
<p>Convert <a href="data/exercise6/exercise6_data.sav">exercise6_data.sav</a> from “Wide” format to “Long” format</p>
</section>
<section id="exercise-7-restructuring-ii-long-to-wide" class="level2" data-number="3.8">
<h2 data-number="3.8" class="anchored" data-anchor-id="exercise-7-restructuring-ii-long-to-wide"><span class="header-section-number">3.8</span> Exercise 7 – Restructuring II (Long to Wide)</h2>
<p>Convert <a href="data/exercise7/exercise7_data.sav">exercise7_data.sav</a> from “Long” format to “Wide” format</p>
<p>(Both exercises to be done together.)</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./02-variables.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Working with Variables</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./04-stats.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Understanding Graphical &amp; Statistical Procedures</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>